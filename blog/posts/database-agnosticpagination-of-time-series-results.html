<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="minimum-scale=1, initial-scale=1, width=device-width, shrink-to-fit=no, viewport-fit=cover"/><title>Nadun De Silva | Blog - <!-- -->Database Agnostic Pagination of Time-Series Results</title><meta name="next-head-count" content="3"/><meta charSet="UTF-8"/><meta name="theme-color" content="#3f51b5"/><meta http-equiv="X-DNS-Prefetch-Control" content="on"/><meta http-equiv="Strict-Transport-Security" content="max-age=63072000; includeSubDomains; preload"/><meta http-equiv="X-XSS-Protection" content="1; mode=block"/><meta http-equiv="Permissions-Policy" content=""/><meta http-equiv="X-Content-Type-Options" content="nosniff"/><meta http-equiv="Referrer-Policy" content="origin"/><meta http-equiv="Content-Security-Policy" content="default-src &#x27;none&#x27;; manifest-src &#x27;self&#x27;; img-src &#x27;self&#x27; data: https://nadundesilva.imgix.net https://www.google.lk https://www.googletagmanager.com; style-src &#x27;unsafe-inline&#x27;; style-src-elem &#x27;self&#x27; &#x27;unsafe-inline&#x27;; font-src &#x27;self&#x27;; script-src &#x27;self&#x27; https://www.googletagmanager.com http://www.googletagmanager.com &#x27;sha256-zGXNhnZec+38XK4g2xHGdVAURhFrFDpw+SmUnNuuFr4=&#x27; &#x27;sha256-CnLuI7DefZ5avS8yKkus4bsgcDh4kOpq8JeXI+hBkuo=&#x27;; connect-src &#x27;self&#x27; https://www.google-analytics.com; prefetch-src &#x27;self&#x27;"/><meta name="application-name" content="Nadun De Silva"/><meta name="description" content="Nadun De Silva is an aspiring Software Engineer interested in Deep Learning, Observability, Anomaly Detection &amp;amp; Cloud Technologies."/><meta name="theme-color" content="#000000"/><link rel="manifest" href="https://nadundesilva.github.io/manifest.json"/><link rel="shortcut icon" href="https://nadundesilva.github.io/favicon.png"/><link rel="canonical" href="https://nadundesilva.github.io/blog/posts/database-agnosticpagination-of-time-series-results"/><link rel="preconnect" href="https://nadundesilva.imgix.net"/><link rel="apple-touch-icon" href="https://nadundesilva.github.io/assets/profile-photo.jpg"/><meta property="fb:app_id" content="567329184466353"/><meta property="og:title" content="Nadun De Silva"/><meta property="og:site_name" content="Nadun De Silva"/><meta property="og:type" content="profile"/><meta property="og:fb:profile_id" content="nadunrds"/><meta property="og:locale" content="en_US"/><meta property="og:description" content="Nadun De Silva is an aspiring Software Engineer interested in Deep Learning, Observability, Anomaly Detection &amp;amp; Cloud Technologies."/><meta property="og:url" content="https://nadundesilva.github.io"/><meta property="og:image" content="https://nadundesilva.github.io/assets/profile-photo.jpg"/><meta property="og:image:height" content="1960"/><meta property="og:image:width" content="1960"/><meta property="og:image:alt" content="Nadun De Silva"/><meta property="twitter:card" content="summary"/><meta property="twitter:title" content="Nadun De Silva"/><meta property="twitter:description" content="Nadun De Silva is an aspiring Software Engineer interested in Deep Learning, Observability, Anomaly Detection &amp;amp; Cloud Technologies."/><meta property="twitter:image" content="https://nadundesilva.github.io/assets/profile-photo.jpg"/><meta property="twitter:image:alt" content="Nadun De Silva"/><meta property="twitter:site" content="@nadunrds"/><meta name="google-site-verification" content="M8dg6gzVYU0noXFvsPOqknm_WjREFeNE212YeUk0g30"/><meta name="yandex-verification" content="acbc45e5d9645cf0"/><script type="application/ld+json">{"@type":"Person","image":{"height":"1960","width":"1960","url":"https://nadundesilva.github.io/assets/profile-photo.jpg","@type":"imageObject"},"url":"https://nadundesilva.github.io","sameAs":["https://www.facebook.com/nadunrds","https://www.linkedin.com/in/nadundesilva","https://www.instagram.com/nadunrds","https://github.com/nadundesilva","https://twitter.com/nadunrds","https://scholar.google.com/citations?user=CdXo_YQAAAAJ"],"description":"Nadun De Silva is an aspiring Software Engineer interested in Deep Learning, Observability, Anomaly Detection &amp; Cloud Technologies.","name":"Nadun De Silva","@context":"https://schema.org"}</script><script async="" defer="" src="https://www.googletagmanager.com/gtag/js?id=GTM-T9KX7B4"></script><script>
                            window.dataLayer = window.dataLayer || [];
                            function gtag() {
                                dataLayer.push(arguments);
                            }
                            gtag("js", new Date());
                            gtag("config", "GTM-T9KX7B4", {
                                page_path: window.location.pathname,
                            });
                        </script><link rel="preload" href="/_next/static/media/934c4b7cb736f2a3.p.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/15d98b06aa40ebc8.css" as="style"/><link rel="stylesheet" href="/_next/static/css/15d98b06aa40ebc8.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-6f60cb26ba168dc7.js" defer=""></script><script src="/_next/static/chunks/framework-5ac2b14b431a77fa.js" defer=""></script><script src="/_next/static/chunks/main-2536303874e79724.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4975339597d73a72.js" defer=""></script><script src="/_next/static/chunks/c16184b3-6e5f6ea01b49506e.js" defer=""></script><script src="/_next/static/chunks/86-ebfcdc9e05bc0018.js" defer=""></script><script src="/_next/static/chunks/664-bc76ec808af62299.js" defer=""></script><script src="/_next/static/chunks/pages/blog/posts/database-agnosticpagination-of-time-series-results-94c9c8c6e695f0a4.js" defer=""></script><script src="/_next/static/Q-749jEZiY8CM4NduBTH0/_buildManifest.js" defer=""></script><script src="/_next/static/Q-749jEZiY8CM4NduBTH0/_ssgManifest.js" defer=""></script><style data-emotion="css "></style></head><body><div id="__next"><main class="__className_19bf8f"><style data-emotion="css-global o6gwfi">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;background-color:#fff;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#fff;}</style><div class="MuiContainer-root MuiContainer-disableGutters css-8d97to"><header class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation0 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionFixed mui-fixed css-1d18wbg" data-testid="app-bar"><div class="MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-i6s8oy"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-edgeStart MuiIconButton-sizeMedium css-18jx27t" tabindex="0" type="button" aria-label="open drawer"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="MenuIcon"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></button><h1 class="MuiTypography-root MuiTypography-h5 css-zq6grw">Nadun De Silva</h1><div class="MuiBox-root css-i9gxme"></div><div class="MuiBox-root css-13tqxrv"><a href="/experience"><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-disableElevation MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-disableElevation css-bz1zsr" tabindex="0" type="button">Experience</button></a><a href="/achievements"><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-disableElevation MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-disableElevation css-bz1zsr" tabindex="0" type="button">Achievements</button></a><a href="/education"><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-disableElevation MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-disableElevation css-bz1zsr" tabindex="0" type="button">Education</button></a><a href="/projects"><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-disableElevation MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-disableElevation css-bz1zsr" tabindex="0" type="button">Projects</button></a><a href="/blog"><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-disableElevation MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-disableElevation css-bz1zsr" tabindex="0" type="button">Blog</button></a></div><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeSmall css-1o4fqe1" tabindex="0" type="button" aria-label="Change to dark theme"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="moon" class="svg-inline--fa fa-moon " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" style="transform-origin:0.375em 0.5em"><g transform="translate(192 256)"><g transform="translate(0, 0)  scale(1.25, 1.25)  rotate(0 0 0)"><path fill="currentColor" d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z" transform="translate(-192 -256)"></path></g></g></svg></button></div></header><div class="MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-i6s8oy"></div><div class="MuiContainer-root MuiContainer-disableGutters css-13va7b1"><div class="MuiContainer-root MuiContainer-disableGutters css-n5rtt0"><nav class="MuiTypography-root MuiTypography-body1 MuiBreadcrumbs-root css-7c1d5x" aria-label="breadcrumb"><ol class="MuiBreadcrumbs-ol css-nhb8h9"><li class="MuiBreadcrumbs-li"><a href="/">Home</a></li><li aria-hidden="true" class="MuiBreadcrumbs-separator css-3mf706"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-right" class="svg-inline--fa fa-chevron-right " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" style="transform-origin:0.375em 0.5em"><g transform="translate(192 256)"><g transform="translate(0, 0)  scale(0.75, 0.75)  rotate(0 0 0)"><path fill="currentColor" d="M342.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L274.7 256 105.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z" transform="translate(-192 -256)"></path></g></g></svg></li><li class="MuiBreadcrumbs-li"><a href="/blog">Blog</a></li><li aria-hidden="true" class="MuiBreadcrumbs-separator css-3mf706"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-right" class="svg-inline--fa fa-chevron-right " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" style="transform-origin:0.375em 0.5em"><g transform="translate(192 256)"><g transform="translate(0, 0)  scale(0.75, 0.75)  rotate(0 0 0)"><path fill="currentColor" d="M342.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L274.7 256 105.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z" transform="translate(-192 -256)"></path></g></g></svg></li><li class="MuiBreadcrumbs-li"><p class="MuiTypography-root MuiTypography-body1 css-nbfzex">Post</p></li></ol></nav><div class="MuiContainer-root css-10ur324"><style data-emotion="css j9vq2b">.css-j9vq2b{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;padding-top:16px;font-weight:700;font-size:35px;}</style><h1 class="MuiTypography-root MuiTypography-h3 css-j9vq2b">Database Agnostic Pagination of Time-Series Results</h1><style data-emotion="css 16p4zmj">.css-16p4zmj{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;position:relative;height:500px;margin-top:16px;margin-bottom:16px;}@media (min-width:1200px){.css-16p4zmj{max-width:1200px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthLg MuiContainer-disableGutters css-16p4zmj"><img alt="Database Agnostic Pagination of Time-Series Results - Main Image" sizes="100vw" srcSet="https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/main.jpeg?w=640&amp;ixlib=react-9.6.0 640w, https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/main.jpeg?w=750&amp;ixlib=react-9.6.0 750w, https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/main.jpeg?w=828&amp;ixlib=react-9.6.0 828w, https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/main.jpeg?w=1080&amp;ixlib=react-9.6.0 1080w, https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/main.jpeg?w=1200&amp;ixlib=react-9.6.0 1200w, https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/main.jpeg?w=1920&amp;ixlib=react-9.6.0 1920w, https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/main.jpeg?w=2048&amp;ixlib=react-9.6.0 2048w, https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/main.jpeg?w=3840&amp;ixlib=react-9.6.0 3840w" src="https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/main.jpeg?w=3840&amp;ixlib=react-9.6.0" decoding="async" data-nimg="fill" loading="lazy" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;object-fit:cover;color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http%3A//www.w3.org/2000/svg&#x27;%3E%3Cimage style=&#x27;filter:blur(20px)&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; height=&#x27;100%25&#x27; width=&#x27;100%25&#x27; href=&#x27;data:image/webp;base64,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&#x27;/%3E%3C/svg%3E&quot;)"/></div><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg">If you are working with Observability or any Data Science field, chances are that you have to work with time-series
data at one point or the other. This is because most practical applications of data science will include a time
dimension and it is generally useful to preserve this information in many cases.</p>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg">A common issue when dealing with such time-series data, is the sheer volume of data that is collected and the
challenges that comes along with dealing with such data.</p>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg">Today in this article, I will be focusing on one such issue, which is paginating time series data. Pagination is
important in any solution and helps clients to process or visualize data without getting overwhelmed by the the sheer
volume of all the relevant data.</p>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg">Moreover, most large scale time-series databases has hard limits on the number of results that can be returned in a
single query (For Azure Data Explorer this was set at 500,000 rows or 64 MB (whichever is lower) at the time I was
writing the article). This can result in problems if you wish to query large amounts of data through the REST APIs.</p>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg">In this article, I will be walking you through a solution which we had to implement due to the lack of database side
pagination support in Azure Data Explorer and in other products powered by it. However, the approach used in this
article is <strong>database agnostic</strong> and it should work with any time-series database out there.</p>
<style data-emotion="css 1wtul99">.css-1wtul99{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;text-align:center;font-size:30px;letter-spacing:20px;}@media (min-width:600px){.css-1wtul99{padding-left:24px;padding-right:24px;}}@media (min-width:1200px){.css-1wtul99{max-width:1200px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthLg css-1wtul99">...</div>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg">Now let’s take a look how to implement pagination in time-series data even without any support for it from the
time-series database itself.</p>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg"><strong>Note:</strong> I have assumed that the time series database will return an error when database limits are hit along with a
partial results set. This is simply to follow the behavior of the Azure Data Explorer that I tested this with. However,
if only an error is returned without a partial results set, the algorithm can still be modified to address it).</p>
<div class="MuiContainer-root MuiContainer-maxWidthLg MuiContainer-disableGutters css-16p4zmj"><img alt="Idea" sizes="100vw" srcSet="https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/idea.jpeg?w=640&amp;ixlib=react-9.6.0 640w, https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/idea.jpeg?w=750&amp;ixlib=react-9.6.0 750w, https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/idea.jpeg?w=828&amp;ixlib=react-9.6.0 828w, https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/idea.jpeg?w=1080&amp;ixlib=react-9.6.0 1080w, https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/idea.jpeg?w=1200&amp;ixlib=react-9.6.0 1200w, https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/idea.jpeg?w=1920&amp;ixlib=react-9.6.0 1920w, https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/idea.jpeg?w=2048&amp;ixlib=react-9.6.0 2048w, https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/idea.jpeg?w=3840&amp;ixlib=react-9.6.0 3840w" src="https://nadundesilva.imgix.net/assets/blog/database-agnosticpagination-of-time-series-results/idea.jpeg?w=3840&amp;ixlib=react-9.6.0" decoding="async" data-nimg="fill" loading="lazy" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;object-fit:cover;color:transparent"/></div>
<style data-emotion="css 1s8cztb">.css-1s8cztb{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:2.125rem;line-height:1.235;letter-spacing:0.00735em;padding-top:56px;font-weight:700;font-size:31px;}</style><h2 class="MuiTypography-root MuiTypography-h4 css-1s8cztb">Pseudo Code for Chunking of Time-series Query Results</h2>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg"><strong>Input:</strong></p>
<ul>
<li><em>start_time</em> - The last timestamp (inclusive) to include in results</li>
<li><em>end_time</em> - The last timestamp (exclusive) to include in results</li>
<li><em>limit</em> - The maximum number of rows to fetch in a single query</li>
</ul>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg"><strong>Utility Functions:</strong></p>
<ul>
<li><em>query_database</em> - Query the database and return results in ascending order</li>
<li><em>process</em> - Process an array of results</li>
<li><em>size_of</em> - Get length of an array</li>
<li><em>timestamp_of</em> - Get the timestamp of a row of results</li>
<li><em>is_server_side_limit_error</em> - Returns true if the error passed in is the server side limit error</li>
</ul>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg"><strong>Algorithm:</strong></p>
<style data-emotion="css tcf1x4">.css-tcf1x4{background-color:#242633;color:#f8f8f2;}.css-tcf1x4 code{background-color:transparent!important;display:block;padding-left:8px;padding-right:8px;padding-top:8px;padding-bottom:8px;margin-top:8px;margin-bottom:8px;}</style><div class="MuiBox-root css-tcf1x4"><pre><code style="display:inline-block;background-color:rgba(228, 231, 237, 0.7);border-radius:2px"><span class="code-line line-number" line="1">current_start_time <span class="token operator">=</span> start_time
</span><span class="code-line line-number" line="2"><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="3">    has_reached_server_side_limit <span class="token operator">=</span> <span class="token boolean">False</span>
</span><span class="code-line line-number" line="4">    rows <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line line-number" line="5">    <span class="token keyword">try</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="6">        rows <span class="token operator">=</span> query_database<span class="token punctuation">(</span>current_start_time<span class="token punctuation">,</span> end_time<span class="token punctuation">,</span> limit<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="7">    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> err<span class="token punctuation">:</span>
</span><span class="code-line line-number" line="8">        <span class="token keyword">if</span> is_server_side_limit_error<span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="9">            has_reached_server_limit <span class="token operator">=</span> <span class="token boolean">True</span>
</span><span class="code-line line-number" line="10">            rows <span class="token operator">=</span> err<span class="token punctuation">.</span>partial_results<span class="token punctuation">.</span>rows  <span class="token comment"># Partial results set</span>
</span><span class="code-line line-number" line="11">        <span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="12">            <span class="token keyword">raise</span> err
</span><span class="code-line line-number" line="13">    row_count <span class="token operator">=</span> size_of<span class="token punctuation">(</span>rows<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="14">    <span class="token keyword">if</span> row_count <span class="token operator">==</span> limit <span class="token keyword">or</span> has_reached_server_side_limit<span class="token punctuation">:</span>
</span><span class="code-line line-number" line="15">        last_timestamp <span class="token operator">=</span> timestamp_of<span class="token punctuation">(</span>rows<span class="token punctuation">[</span>row_count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="16">        i <span class="token operator">=</span> size_of<span class="token punctuation">(</span>rows<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="17">        <span class="token keyword">while</span> i <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> timestamp_of<span class="token punctuation">(</span>rows<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> last_timestamp<span class="token punctuation">:</span>
</span><span class="code-line line-number" line="18">            i<span class="token operator">-</span><span class="token operator">-</span>
</span><span class="code-line line-number" line="19">        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="20">            <span class="token keyword">raise</span> Error<span class="token punctuation">(</span><span class="token string">&quot;Unsupported condition: limit too small&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="21">        rows <span class="token operator">=</span> rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span> <span class="token comment"># Dropping all rows with last timestamp</span>
</span><span class="code-line line-number" line="22">        current_start_time <span class="token operator">=</span> last_timestamp
</span><span class="code-line line-number" line="23">        process<span class="token punctuation">(</span>rows<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="24">    <span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="25">        <span class="token keyword">if</span> row_count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="26">            process<span class="token punctuation">(</span>rows<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="27">        <span class="token keyword">break</span>
</span></code></pre></div>
<h2 class="MuiTypography-root MuiTypography-h4 css-1s8cztb">Explanation</h2>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg">The most important aspect of any pagination algorithm is the way to continue from the last results chunk. In this
algorithm, this is achieved by querying the results in the ascending order and using the last timestamp of the previous
results chunk as the start timestamp of the next results chunk.</p>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg">However, to avoid any overlaps due to repeated timestamps in multiple rows, we need to always drop the last timestamp
in the chunk so that we can fetch results starting from that point to the end of the time range (Line 14–21). There is
an inherent limitation because of this approach, which is explained below.</p>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg">The terminating condition of the querying is detected when the number of returned data is less than the limit specified
and if there were no database side limit errors (Line 24–27).</p>
<h2 class="MuiTypography-root MuiTypography-h4 css-1s8cztb">Limitations &amp; ways to overcome them</h2>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg">While this algorithm will work for many cases, if your data contains multiple repeated timestamps in rows, the
algorithm may fail. This can happen if the limit applied to results chunk is smaller than the maximum number of
repeated timestamps as we are always removing the last. The algorithm will raise an error if this condition is reached
(Line 19–20).</p>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg">However, in many real world applications repeating timestamps in multiple events will be rare. However, there can be
some cases where there are repeated timestamps due to the implementation of how these data points were recorded.
(e.g.:- multiple sensor readings which has the same timestamp, to simplify the sensor reading implementation, even
though they were actually read at least several milliseconds apart).</p>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg">One approach to overcome these limitations in such scenarios, would be to group these events into a single row using
the time-series database query itself.</p>
<div class="MuiContainer-root MuiContainer-maxWidthLg css-1wtul99">...</div>
<h2 class="MuiTypography-root MuiTypography-h4 css-1s8cztb">Conclusion</h2>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg">As you have witnessed above, this approach would work with almost any database without any issues.</p>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg">However, I would like to emphasize the fact that, <strong>we should not try to query all data in this manner unless it is
absolutely necessary</strong>. Querying data in this manner will put a lot of strain on the database as well as the client.</p>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg">You should always try to <strong>aggregate and process the data within the database itself using database queries</strong>. Most of
the time-series databases available today includes rich enough syntax to perform such processing at database side
itself.</p>
<p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-16opbdg">However, in those rare occasions when you have no other alternative (e.g.:- if you are storing logs in an Azure Data
Explorer and would like to implement a logs viewer), hope this approach would save your day.</p></div></div></div><div class="MuiContainer-root css-yjj9hp">© 2021 Nadun De Silva</div><div class="MuiBox-root css-1xkhxpi" role="presentation" style="transform:scale(0);visibility:hidden"><button class="MuiButtonBase-root MuiFab-root MuiFab-circular MuiFab-sizeSmall MuiFab-primary MuiFab-root MuiFab-circular MuiFab-sizeSmall MuiFab-primary css-lzlna5" tabindex="0" type="button" aria-label="scroll back to top"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-up" class="svg-inline--fa fa-chevron-up " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z"></path></svg></button></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/blog/posts/database-agnosticpagination-of-time-series-results","query":{},"buildId":"Q-749jEZiY8CM4NduBTH0","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>